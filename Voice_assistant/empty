import speech_recognition as sr
import wikipedia
import tkinter as tk

def listen_audio():
    recognizer = sr.Recognizer()
    with sr.Microphone() as source:
        print("Listening...")
        audio = recognizer.listen(source)

    try:
        print("Processing audio...")
        query = recognizer.recognize_google(audio)
        print("You asked:", query)
        return query
    except sr.UnknownValueError:
        print("Sorry, I could not understand your question.")
        return None
    except sr.RequestError:
        print("Sorry, I am unable to process your request.")
        return None

def search_wikipedia(query):
    try:
        page = wikipedia.page(query)
        content = page.content
        # Split content into words
        words = content.split()
        # Limit response to 150 words
        words = words[:150]
        # Join words into lines of 35 characters each
        lines = [" ".join(words[i:i+5]) for i in range(0, len(words), 5)]
        formatted_response = "\n".join(lines[:5])  # Limit to 5 lines
        return formatted_response
    except wikipedia.exceptions.DisambiguationError as e:
        print("Multiple results found. Please provide more specific query.")
        return None
    except wikipedia.exceptions.PageError:
        print("No results found. Please try a different query.")
        return None

def display_answer(answer):
    window = tk.Tk()
    window.title("Assistant")
    text_box = tk.Text(window, height=5, width=40)
    text_box.insert(tk.END, answer)
    text_box.pack()
    window.mainloop()

def main():
    query = listen_audio()
    if query:
        search_result = search_wikipedia(query)
        if search_result:
            display_answer(search_result)
        else:
            print("I'm sorry, I couldn't find a relevant answer.")

if __name__ == "__main__":
    main()

